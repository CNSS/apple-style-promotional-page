<!DOCTYPE html>
<html>

<head>
  <title>Home</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="//unpkg.com/@triggerjs/trigger" defer></script>
  <link rel="stylesheet" href="statics/style.css">
</head>

<body>
  <div class="popup-background"></div>
  <div class="popup match">
    <div class="popup-container">
      <button class="popup-close-btn">
        <span class="btn-icon close-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
            <path
              d="M12.12,10l4.07-4.06a1.5,1.5,0,1,0-2.11-2.12L10,7.88,5.94,3.81A1.5,1.5,0,1,0,3.82,5.93L7.88,10,3.81,14.06a1.5,1.5,0,0,0,0,2.12,1.51,1.51,0,0,0,2.13,0L10,12.12l4.06,4.07a1.45,1.45,0,0,0,1.06.44,1.5,1.5,0,0,0,1.06-2.56Z">
            </path>
          </svg>
        </span>
      </button>
      <div class="popup-content">
        <h2>参赛机会</h2>
        <p>CTF、AWD、Penetration、ASC…</p>
        <p>众多比赛,总能让你大放光彩。</p>
        <div class="popup-content-card">
          <span>
            我们组队<b>征战于全国甚至全球各大网络安全竞赛</b>, 这些竞赛大多以每月<b>3~4次或更高的频率</b>举办。
          </span>
          <div class="popup-content-card-image">
            <img src="statics/img/comp.jpg" alt="comp" />
          </div>
        </div>

        <div class="popup-content-card">
          <span>
            在<b>全国各地举办的线下比赛</b>一直是拓宽视野、提升技术的重要途径。在凝聚, 所有线下比赛的<b>费用均由公费报销</b>。
          </span>
          <div class="popup-content-card-image reimbursement" style="--bg: url(/statics/img/reimbursement2.png)">
            <img src="statics/img/reimbursement2.png" alt="reimbursement" />
          </div>
          <div class="popup-content-card-image reimbursement" style="--bg: url(/statics/img/reimbursement1.png)">
            <img src="statics/img/reimbursement1.png" alt="reimbursement" />
          </div>
        </div>

        <div class="popup-content-card">
          <span>
            我们<b>不会强制</b>任何工作室内的成员参加比赛或参加训练，你也可以<b><s>每天睡大觉</s></b>，但CNSS会在你想参与比赛时<b>随时欢迎你</b>。
          </span>
        </div>
      </div>
    </div>
  </div>

  <div class="popup offer">
    <div class="popup-container">
      <button class="popup-close-btn">
        <span class="btn-icon close-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
            <path
              d="M12.12,10l4.07-4.06a1.5,1.5,0,1,0-2.11-2.12L10,7.88,5.94,3.81A1.5,1.5,0,1,0,3.82,5.93L7.88,10,3.81,14.06a1.5,1.5,0,0,0,0,2.12,1.51,1.51,0,0,0,2.13,0L10,12.12l4.06,4.07a1.45,1.45,0,0,0,1.06.44,1.5,1.5,0,0,0,1.06-2.56Z">
            </path>
          </svg>
        </span>
      </button>
      <div class="popup-content">
        <h2>实习与Offer</h2>
        <p>大厂或是名校实验室, </p>
        <p>内推机会多多。</p>
        <div class="popup-content-card">
          <span>
            网安领域一些<b>知名企业的创始人</b>中不乏我们的成员，如<b>长亭科技</b>、<b>万径安全</b>(前四维创智，推出了
            <a href="https://yaklang.io">Yak</a> 等知名产品)等。
          </span>
          <div class="popup-content-card-image yak">
            <img src="statics/img/yak-before.png" alt="yak" />
          </div>
        </div>

        <div class="popup-content-card">
          <span>
            学长学姐们的身影也<b>遍布国内外知名企业</b>。国内大厂如<b>字节跳动</b>、<b>腾讯</b>、<b>阿里巴巴</b>、<b>美团</b>等，外企如
            <b>Microsoft</b>、<b>Google</b> 等，均向凝聚成员发放过
            Offer。不论是实习还是求职，我们都有<b>丰富的内部资源和机会</b>。
          </span>
          <div class="popup-content-card-image offers">
            <img src="statics/img/offers/ms.png" alt="reimbursement" />
          </div>
        </div>

        <div class="popup-content-card">
          <span>
            在凝聚近二十载的历史中, 许多优秀的学长学姐奔赴名校在各个方向求学深耕, 国内如<b>清北</b>、<b>上海交通大学安全研究组 (<a
                href="https://github.com/GoSSIP-SJTU">GoSSIP-SJTU</a>)</b>、<b>中科院信息工程研究所</b>，国外如
            <b>UCR</b>、<b>OSU</b>、<b>Gatech</b>、<b>Kaust</b> 等。每年申请季，都会有许多内推介绍的机会。
          </span>

          <div class="popup-content-card-image schools">
            <img src="statics/img/schools/kaust.png" alt="schools" />
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container title wrapper" tg-name="percent" tg-from="1" tg-to="0.01" tg-edge="inset">
    <div class="container title wrapper" tg-name="rev-percent" tg-from="0" tg-to="0.99" tg-edge="inset">
      <div class="container title sticky">
        <div class="title_content_wrapper">
          <img src="statics/img/logo.svg" class="logo" title="logo" />
          <p>
            <span class="title_abbr c">C</span>
            <span class="title_content ohesion">ohesion&nbsp;</span>
            <span class="title_abbr n">N</span>
            <span class="title_content etwork">etwork&nbsp;</span>
            <span class="title_abbr s">S</span>
            <span class="title_content ecurity">ecurity&nbsp;</span>
            <span class="title_abbr s">S</span>
            <span class="title_content tudio">tudio&nbsp;</span>
            <br />
            <span class="title_chinese">凝聚网络安全工作室</span>
          </p>
        </div>
      </div>
    </div>
  </div>

  <div class="container keywords wrapper" tg-name="percent" tg-from="1" tg-to="0.01" tg-edge="inset">
    <div class="container keywords wrapper" tg-name="rev-percent" tg-from="0" tg-to="0.99" tg-edge="inset">
      <div class="container keywords sticky">
        <b>
          凝聚关键词
        </b>
        <div class="container keywords mask">
          <div data-show class="div keywords">
            <div class="keywords_content">
              <h2>历史悠久</h2>
              <span>凝聚网络安全工作室成立于 2007 年，是成电悠久的工作室文化的代表。我们以电子科技大学本科学生为主力，依托电子科技大学网络空间安全研究中心，旨在培养网络安全领域全面发展的高级人才。</span>
            </div>
          </div>
          <div class="div keywords">
            <div class="keywords_content">
              <h2>成绩斐然</h2>
              <span>CNSS
                发展至今，体系已逐渐完善，不仅在网络安全领域<b>获奖无数</b>，在开发、运维等领域也拥有<b>优异的成绩与深厚的积淀</b>。优良的技术氛围中，历届成员锻炼出了极富竞争力的专业技能。其中不少成员师从安全圈华人顶尖教授，奔赴
                CMU、UCR、OSU、Kaust、清华大学、北京大学、上海交通大学、中国科学院大学等海内外知名高校继续从事安全研究。</span>
            </div>
          </div>
          <div class="div keywords">
            <div class="keywords_content">
              <h2>机遇不断</h2>
              <span>在与外校、企业的合作上，我们<b>机遇不断</b>。我们和腾讯安全科恩实验室、上海交通大学安全研究组
                GoSSIP，中科院信息工程研究所等均有频繁的实习及合作交流。同时，我们与字节跳动、长亭科技、腾讯、阿里巴巴、百度、滴滴等企业有密切合作，享有各大企业丰富的内推指标。</span>
            </div>
          </div>
          <div class="div keywords">
            <div class="keywords_content">
              <h2>最高水平</h2>
              <span>凝聚标志着电子科大本科生在计算机领域的<b>最高水平</b>，一届又一届，我们致力于将严谨的研究氛围、敢于挑战的精神与创新文化不间断地向下传递。</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container cards wrapper" tg-name="percent" tg-from="1" tg-to="0.01" tg-edge="inset">
    <div class="container cards wrapper" tg-name="rev-percent" tg-from="0" tg-to="0.99" tg-edge="inset">
      <div class="container cards sticky">
        <b class="cards-title">
          加入凝聚, 你将可能获得
        </b>
        <div class="container cards list">
          <ul class="card-set">
            <li class="list-items placeholder"></li>
            <li class="list-items">
              <div class="card">
                <div class="card face" popup="match">
                  <div class="text">
                    <h3>
                      参赛机会
                    </h3>
                    <span>CTF、AWD、Penetration、ASC…</span>
                    <br />
                    <span>众多比赛,总能让你大放光彩。</span>
                  </div>
                  <button class="card-more-btn">
                    <span class="btn-icon more-icon">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
                        class="card-cta-modal-button-small-icon card-modal-button-small-icon">
                        <path
                          d="M17.25,8.51H11.5V2.75A1.5,1.5,0,0,0,10,1.25h0a1.5,1.5,0,0,0-1.5,1.5V8.5H2.75a1.5,1.5,0,0,0,0,3H8.5v5.75a1.5,1.5,0,0,0,1.5,1.5h0a1.5,1.5,0,0,0,1.5-1.5V11.5h5.75a1.5,1.5,0,0,0,0-3Z">
                        </path>
                      </svg>
                    </span>
                  </button>
                </div>
                <button class="card button more"></button>
              </div>

            </li>

            <li class="list-items">
              <div class="card">
                <div class="card face" popup="offer">
                  <div class="text">
                    <h3>
                      实习与Offer
                    </h3>
                    <span>大厂或是名校实验室,</span>
                    <br />
                    <span>内推机会多多。</span>
                  </div>
                  <button class="card-more-btn">
                    <span class="btn-icon more-icon">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
                        class="card-cta-modal-button-small-icon card-modal-button-small-icon">
                        <path
                          d="M17.25,8.51H11.5V2.75A1.5,1.5,0,0,0,10,1.25h0a1.5,1.5,0,0,0-1.5,1.5V8.5H2.75a1.5,1.5,0,0,0,0,3H8.5v5.75a1.5,1.5,0,0,0,1.5,1.5h0a1.5,1.5,0,0,0,1.5-1.5V11.5h5.75a1.5,1.5,0,0,0,0-3Z">
                        </path>
                      </svg>
                    </span>
                  </button>
                </div>
                <button class="card button more"></button>
              </div>
            </li>

            <li class="list-items">
              <div class="card">
                <div class="card face" popup="money">
                  <div class="text">
                    <h3>
                      奖金与报酬
                    </h3>
                    <span>丰厚的比赛奖金、培训报酬。</span>
                    <br />
                    <span>线下比赛所有费用均由公费报销。</span>
                  </div>
                  <button class="card-more-btn">
                    <span class="btn-icon more-icon">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
                        class="card-cta-modal-button-small-icon card-modal-button-small-icon">
                        <path
                          d="M17.25,8.51H11.5V2.75A1.5,1.5,0,0,0,10,1.25h0a1.5,1.5,0,0,0-1.5,1.5V8.5H2.75a1.5,1.5,0,0,0,0,3H8.5v5.75a1.5,1.5,0,0,0,1.5,1.5h0a1.5,1.5,0,0,0,1.5-1.5V11.5h5.75a1.5,1.5,0,0,0,0-3Z">
                        </path>
                      </svg>
                    </span>
                  </button>
                </div>
                <button class="card button more"></button>
              </div>
            </li>

            <li class="list-items">
              <div class="card">
                <div class="card face" popup="train">
                  <div class="text">
                    <h3>
                      内部训练场
                    </h3>
                    <span>想提升自己?</span>
                    <br />
                    <span>内部训练平台满足你!</span>
                    <br />
                    <br />
                    <span style="font-style:italic; opacity: 0.8;">P.S. 我们并不会强制工作室内的成员参加比赛或参加训练,
                      但CNSS会在你想参与比赛时随时欢迎你。</span>
                  </div>
                  <button class="card-more-btn">
                    <span class="btn-icon more-icon">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
                        class="card-cta-modal-button-small-icon card-modal-button-small-icon">
                        <path
                          d="M17.25,8.51H11.5V2.75A1.5,1.5,0,0,0,10,1.25h0a1.5,1.5,0,0,0-1.5,1.5V8.5H2.75a1.5,1.5,0,0,0,0,3H8.5v5.75a1.5,1.5,0,0,0,1.5,1.5h0a1.5,1.5,0,0,0,1.5-1.5V11.5h5.75a1.5,1.5,0,0,0,0-3Z">
                        </path>
                      </svg>
                    </span>
                  </button>
                </div>
                <button class="card button more"></button>
              </div>
            </li>

            <li class="list-items">
              <div class="card">
                <div class="card face" popup="family">
                  <div class="text">
                    <h3>
                      志同道合的好友们
                    </h3>
                    <span>最重要的是认识我们大家</span>
                    <br />
                    <span>一起交流技术、聚餐、玩桌游、玩游戏和好友们</span>
                  </div>
                  <button class="card-more-btn">
                    <span class="btn-icon more-icon">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
                        class="card-cta-modal-button-small-icon card-modal-button-small-icon">
                        <path
                          d="M17.25,8.51H11.5V2.75A1.5,1.5,0,0,0,10,1.25h0a1.5,1.5,0,0,0-1.5,1.5V8.5H2.75a1.5,1.5,0,0,0,0,3H8.5v5.75a1.5,1.5,0,0,0,1.5,1.5h0a1.5,1.5,0,0,0,1.5-1.5V11.5h5.75a1.5,1.5,0,0,0,0-3Z">
                        </path>
                      </svg>
                    </span>
                  </button>
                </div>
                <button class="card button more"></button>
              </div>
            </li>
            <li class="list-items placeholder"></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</body>

<script>
  let isVertical = false;
  if (window.innerHeight > window.innerWidth) {
    isVertical = true;
  }

  // 解决直接用 triggerjs 会闪烁的问题
  const title_chinese = document.getElementsByClassName("title_chinese")[0];
  const titleWrapper = document.getElementsByClassName("container title wrapper")[0];
  title_chinese.style.setProperty('--perc', "0%")
  document.addEventListener('scroll', (e) => {
    let scrolled = titleWrapper.style.getPropertyValue('--percent');
    console.log(scrolled)
    if (scrolled > 1) {
      scrolled = 1
    } else if (scrolled < 0) {
      scrolled = 0
    }
    title_chinese.style.setProperty('--perc', `${scrolled * 100}%`)
  })

  // 切换关键词
  const keywordsWrapper = document.getElementsByClassName("container keywords wrapper")[0];
  document.addEventListener('scroll', (e) => {
    let scrolled = 1 - keywordsWrapper.style.getPropertyValue('--percent');
    console.log(scrolled)
    if (scrolled > 1) {
      scrolled = 1
    } else if (scrolled < 0) {
      scrolled = 0
    }
    let keywords = document.getElementsByClassName("div keywords");
    if (keywords.length == 0) {
      return;
    }
    let select = Math.floor(scrolled * keywords.length);
    let up = null;
    for (let i = 0; i < keywords.length; i++) {
      if (keywords[i].hasAttribute('data-show')) {
        show = i;
      }
    }

    for (let i = 0; i < select; i++) {
      if (!keywords[i].hasAttribute['data-up']) {
        keywords[i].setAttribute('data-up', '');
      }
      if (keywords[i].hasAttribute('data-show')) {
        keywords[i].removeAttribute('data-show');
      }
    }

    for (let i = select; i < keywords.length; i++) {
      if (keywords[i].hasAttribute('data-up')) {
        keywords[i].removeAttribute('data-up');
      }
      if (keywords[i].hasAttribute('data-show')) {
        keywords[i].removeAttribute('data-show');
      }
    }

    keywords[select].setAttribute('data-show', '');
  })

  // 防止弹窗正文部分点击穿透
  const popupContainers = document.getElementsByClassName("popup-container");
  for (let i = 0; i < popupContainers.length; i++) {
    popupContainers[i].addEventListener('click', (e) => {
      e.stopPropagation();
    })
  }

  const popupBackground = document.getElementsByClassName("popup-background")[0];
  // 绑定弹窗
  function popup(popupElement) {
    popupBackground.style.display = "block";
    popupElement.style.display = "block";
    popupElement.style.opacity = 1;
    this.setTimeout(() => {
      popupBackground.style.setProperty('backdrop-filter', 'blur(20px)');
      popupBackground.style.setProperty('--webkit-backdrop-filter', 'blur(20px)');
      popupElement.style.top = 0;
    }, 0);

    // set overflow:hidden to body and html
    document.body.style.overflow = "hidden";
    document.documentElement.style.overflow = "hidden";

    // add close event
    function eventClose(popupElement) {
      popupElement.style.top = "100%";
      popupBackground.style.setProperty('backdrop-filter', 'blur(0px)');
      popupBackground.style.setProperty('--webkit-backdrop-filter', 'blur(0px)');
      this.setTimeout(() => {
        popupElement.style.display = "none";
        popupBackground.style.display = "none";
      }, 400);
      // remove overflow:hidden
      document.body.style.overflow = "";
      document.documentElement.style.overflow = "";
    }

    popupElement.getElementsByClassName("popup-close-btn")[0].addEventListener('click', eventClose.bind(this, popupElement));
    popupElement.addEventListener('click', eventClose.bind(this, popupElement));
  }

  // Card List-items add popup onclick event
  const cardFaces = document.getElementsByClassName("card face");
  for (let i = 0; i < cardFaces.length; i++) {
    let popupName = cardFaces[i].getAttribute("popup");
    let popupElement = document.getElementsByClassName("popup " + popupName)[0];
    let button = cardFaces[i].parentElement.getElementsByClassName("card button")[0];
    button.addEventListener('click', popup.bind(this, popupElement));
  }


  // 检测图片滚动进度
  const reimbursement = document.getElementsByClassName("popup-content-card-image reimbursement");
  const matchPopup = document.getElementsByClassName("popup match")[0].getElementsByClassName("popup-container")[0];
  matchPopup.addEventListener('scroll', (e) => {
    for (let i = 0; i < reimbursement.length; i++) {
      if (reimbursement[i].getBoundingClientRect().top < window.innerHeight && reimbursement[i].getBoundingClientRect().bottom > 0) {
        let scrolled = 1 - reimbursement[i].getBoundingClientRect().top / window.innerHeight;
        range = [0.1, 0.4];
        scrolled = (scrolled - range[0]) / (range[1] - range[0]);
        if (scrolled > 1) {
          scrolled = 1
        } else if (scrolled < 0) {
          scrolled = 0
        }
        let size = `${Math.floor(scrolled * 80)}%`
        if (reimbursement[i].style.getPropertyValue('background-size') != size) {
          reimbursement[i].style.setProperty('background-size', size)
        }
      }
    }
  })



  let offersImages = ["ms", "bd", "ali", "jd", "tx"];
  let schoolsImages = ["kaust", "cmu", "pku", "thu"];
  const yak = document.getElementsByClassName("popup-content-card-image yak")[0];
  const offers = document.getElementsByClassName("popup-content-card-image offers")[0];
  const schools = document.getElementsByClassName("popup-content-card-image schools")[0];
  const offerPopup = document.getElementsByClassName("popup offer")[0].getElementsByClassName("popup-container")[0];

  yak.style.setProperty('--percent', 0)
  offers.style.setProperty('--bg-opacity', 0)
  schools.style.setProperty('--bg-opacity', 0)

  // 预加载
  let bg = ""
  for (let i = 0; i < offersImages.length; i++) {
    bg += `url(./img/offers/${offersImages[i]}.png) no-repeat center center / cover,`;
  }
  offers.style.setProperty('--bg', bg.slice(0, -1));

  bg = ""
  for (let i = 0; i < schoolsImages.length; i++) {
    bg += `url(./img/schools/${schoolsImages[i]}.png) no-repeat center center / cover,`;
  }

  let handler = (e) => {
    // Yak 聚光灯效果
    if (!isVertical) {
      if (yak.getBoundingClientRect().top < window.innerHeight && yak.getBoundingClientRect().bottom > 0) {
        let scrolled = 1 - yak.getBoundingClientRect().top / window.innerHeight;
        if (scrolled > 1) {
          scrolled = 1
        } else if (scrolled < 0) {
          scrolled = 0
        }
        if (isVertical) {
          yak.style.setProperty('--percent', `${scrolled}`)
        } else {
          yak.style.setProperty('--percent', `${scrolled - 0.5}`)
        }
      }
    }


    // Offers 逐个出现
    if (offers.getBoundingClientRect().top < window.innerHeight && offers.getBoundingClientRect().bottom > 0) {
      let scrolled = 1 - offers.getBoundingClientRect().top / window.innerHeight;
      let range = [0.3, 0.8];
      if (isVertical) {
        range = [0.1, 0.6];
      }
      scrolled = (scrolled - range[0]) / (range[1] - range[0]);
      if (scrolled > 1) {
        scrolled = 1
      } else if (scrolled < 0) {
        scrolled = 0
      }

      let percent = scrolled * offersImages.length
      let select = Math.floor(percent);
      let bg = ""
      for (let i = select - 1; i >= 0; i--) {
        bg += `url("/statics/img/offers/${offersImages[i]}.png") no-repeat center center / cover,`;
      }
      bg = bg.slice(0, -1);
      if (offers.style.getPropertyValue('--bg') != bg) {
        offers.style.setProperty('--bg', bg);
        if (select < offersImages.length) {
          offers.style.setProperty('--after-bg', `url("/statics/img/offers/${offersImages[select]}.png") no-repeat center center / cover`);
        } else {
          offers.style.setProperty('--after-bg', `rgba(0, 0, 0, 0)`);
        }
      }

      let opacity = percent - select;
      opacity = Math.round(opacity * 100) / 100;
      if (offers.style.getPropertyValue('--bg-opacity') != opacity) {
        offers.style.setProperty('--bg-opacity', opacity);
      }
    }


    // Schools 逐个出现
    if (schools.getBoundingClientRect().top < window.innerHeight && schools.getBoundingClientRect().bottom > 0) {
      let scrolled = 1 - schools.getBoundingClientRect().top / window.innerHeight;
      let range = [0.3, 0.8];
      if (isVertical) {
        range = [0, 0.3];
      }
      scrolled = (scrolled - range[0]) / (range[1] - range[0]);
      if (scrolled > 1) {
        scrolled = 1
      } else if (scrolled < 0) {
        scrolled = 0
      }
      let percent = scrolled * schoolsImages.length
      let select = Math.floor(percent);
      let bg = ""
      for (let i = select - 1; i >= 0; i--) {
        bg += `url("/statics/img/schools/${schoolsImages[i]}.png") no-repeat center center / cover,`;
      }
      bg = bg.slice(0, -1);
      if (schools.style.getPropertyValue('--bg') != bg) {
        schools.style.setProperty('--bg', bg);
        if (select < schoolsImages.length) {
          schools.style.setProperty('--after-bg', `url("/statics/img/schools/${schoolsImages[select]}.png") no-repeat center center / cover`);
        } else {
          schools.style.setProperty('--after-bg', `none`);
        }
      }
      let opacity = percent - select;
      opacity = Math.round(opacity * 100) / 100;
      if (schools.style.getPropertyValue('--bg-opacity') != opacity) {
        schools.style.setProperty('--bg-opacity', opacity);
      }
    }
  }
  offerPopup.addEventListener('scroll', handler)
</script>

</html>
